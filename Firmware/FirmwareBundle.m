/*!
 @source FirmwareBundle.m
 @project Pusher
 @author Alexander Maksimenko
 @copyright Copyright (c) 2009 Ripdev. All rights reserved.
 */

#import "FirmwareBundle.h"

@implementation FirmwareBundle

-(id) initWithInfo:(NSDictionary*) info path:(NSString*) path
{
    self = [super init];
    
    _info = [info retain];
    _path = [path copy];
    
    return self;
}

-(void) dealloc
{
    [_info release];
    [_path release];
    
    [super dealloc];
}

-(void) encodeWithCoder:(NSCoder*) encoder
{
	[encoder encodeObject:_info];
	[encoder encodeObject:_path];
}

-(id) initWithCoder:(NSCoder*) decoder
{
    [_info release];
    _info = [[decoder decodeObject] retain];
    
    [_path release];
    _path = [[decoder decodeObject] copy];

	return self;
}

-(NSString*) path
{
    return [[_path copy] autorelease];
}

-(NSString*) name
{
    return [_info objectForKey:NameKey];
}

-(int) version
{
    return [[_info objectForKey:VersionKey] intValue];
}

-(Platform) platform
{
    return [[_info objectForKey:PlatformKey] intValue];
}

-(NSString*) filename
{
    return [_info objectForKey:FilenameKey];
}

-(NSString*) sha1
{
    return [_info objectForKey:SHA1Key];
}

-(NSString*) rootFilesystem
{
    return [_info objectForKey:RootFilesystemKey];
}

-(NSString*) rootFilesystemKey
{
    return [_info objectForKey:RootFilesystemKeyKey];
}

-(NSString*) rootFilesystemMountVolume
{
    return [_info objectForKey:RootFilesystemMountVolumeKey];
}

-(double) rootFilesystemSize
{
    return (double)[[_info objectForKey:RootFilesystemSizeKey] intValue];
}

-(double) rootFilesystemUsedSpace
{
    return (double)[[_info objectForKey:RootFilesystemUsedSpaceKey] intValue];
}

-(NSString*) ramdiskMountVolume
{
    return [_info objectForKey:RamdiskMountVolumeKey];
}

-(NSString*) downloadUrl
{
    return [_info objectForKey:DownloadUrlKey];
}

-(NSArray*) preInstalledCustomPackages
{
    return [_info objectForKey:PreInstalledPackagesKey];
}

-(NSDictionary*) firmwarePatches
{
    return [_info objectForKey:FirmwarePatchesKey];
}

-(NSDictionary*) filesystemPatches
{
    return [_info objectForKey:FilesystemPatchesKey];
}

-(NSDictionary*) basebandPatches
{
    return [_info objectForKey:BasebandPatchesKey];
}

-(BOOL) bbUpdateAvailable
{
    return ([_info objectForKey:BasebandPatchesKey] != nil);
}

-(BOOL) phoneActivationAvailable
{
    return ([[_info objectForKey:FilesystemPatchesKey] objectForKey:FSPhoneActivationKey] != nil);
}

@end