/*!
 @header SecureTask.h
 @project Pusher
 @author Alexander Maksimenko
 @copyright Copyright (c) 2009 Ripdev. All rights reserved.
 */

#include <Security/Authorization.h>
#include <Security/AuthorizationTags.h>

@interface SecureTask : NSObject
{
	AuthorizationRef authorizationRef;
    NSMutableString* _output;
    NSString* _helperPath;
}

-(BOOL) isAuthenticated:(NSString*) task;
-(BOOL) authenticate:(NSString*) task;
-(void) deauthenticate;

-(BOOL) runTaskWithArgs:(char * const *) args;
-(void) drainOutput:(FILE*) file;
-(int) readPid:(FILE*) file;
-(NSString*) output;

@end
